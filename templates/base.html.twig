<!DOCTYPE html>
<html lang="{{ app.request.locale|default('fr') }}">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    {% if (turbo_force_reload|default(false)) == true %}
      <meta name="turbo-visit-control" content="reload" />
    {% endif %}
    <meta name="turbo-prefetch" content="{{ env.app.enable_prefetch ? 'true' : 'false' }}" />
    {# <meta name="turbo-refresh-method" content="morph" /> #}
    {# <meta name="turbo-refresh-scroll" content="preserve" /> #}

    <title>
      {{ title ~ ' - ' ~ ('layout.name'|trans) }}
    </title>

    <link rel="icon" href=" {{ asset('build/favicon.png') }}" />

    {% block stylesheets %}
      {{ encore_entry_link_tags('app') }}
    {% endblock %}

    {% block javascripts %}
      {{ encore_entry_script_tags('app') }}
    {% endblock %}
  </head>

  <body class="d-flex flex-column min-vh-100">
    {# Bar not visible in prod env #}
    {% if env.app.env != 'prod' %}
      <div class="container-fluid p-0 m-0 text-center fw-bold d-flex justify-content-around app-env-dev">
        {% for i in 1..10 %}
          <div>
            {{ env.app.env|upper }}
          </div>
        {% endfor %}
      </div>
    {% endif %}

    {# Skip to content link for screen reader #}
    <div class="ps-3 app-skip-link">
      <a class="icon-link visually-hidden-focusable" href="#main-content">{{ 'aria.skipToContent'|trans }}</a>
    </div>

    {# The HEADER regroup the navbar and the main title #}
    <header>
      <nav class="navbar navbar-expand-md bg-body-secondary" aria-label="{{ 'aria.mainNavigation'|trans }}">
        {% set currentRoute = app.current_route %}
        {% set activeLink = 'class="nav-link active" aria-current="page" aria-selected="true"' %}
        {% set otherLink = 'class="nav-link"' %}
        {# Navbar with 3 blocks : the brand, the navigation button for small screen and the content #}
        <div class="container-fluid">
          {# Brand #}
          <div class="navbar-brand">
            {{ 'layout.name'|trans }}
          </div>
          {# Navigation button for small screen #}
          <button class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbar-supported-content"
            aria-controls="navbar-supported-content"
            aria-expanded="false"
            aria-label="{{ 'aria.toggleNavigation'|trans }}">
            <span class="navbar-toggler-icon"></span>
          </button>
          {# Content as two lists : one on the left, the other on the right for lage screen / both on the top of each other for small screen #}
          <div class="collapse navbar-collapse" id="navbar-supported-content">
            {# Left part of the navbar #}
            <ul class="navbar-nav me-auto mb-2 mb-md-0">
              <li class="nav-item">
                <a {{ currentRoute starts with 'home' ? activeLink|raw : otherLink|raw }} href="{{ path('home_index') }}">{{ 'layout.navbar.home'|trans }}</a>
              </li>
              <li class="nav-item">
                <a {{ currentRoute starts with 'game' ? activeLink|raw : otherLink|raw }} href="{{ path('game_index') }}">{{ 'layout.navbar.game'|trans }}</a>
              </li>
            </ul>
            {# Right part of the navbar #}
            <ul class="navbar-nav">
              <li class="nav-item dropdown">
                <a class="nav-link {{ currentRoute starts with 'review' ? 'active' }} dropdown-toggle app-dropdown-left app-dropdown-smooth d-flex align-items-center"
                  href="#"
                  role="button"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                  aria-haspopup="true"
                  {{ currentRoute starts with 'review' ? 'aria-current="page" aria-selected="true"' }}>
                  <span class="me-1">{{ app.user.username }}</span>
                  <img src="{{ app.user.avatarPath|hub_url_generate_root }}"
                    class="img-fluid ms-1 app-avatar-navbar"
                    alt="{{ 'aria.avatar'|trans({ name: app.user.username }) }}" />
                </a>
                <ul class="dropdown-menu dropdown-menu-end" role="menu">
                  <li><a class="dropdown-item" role="menuitem" href="{{ path('review_index') }}">{{ 'layout.navbar.account.myReviews'|trans }}</a></li>
                  <li><hr class="dropdown-divider" /></li>
                  <li>
                    <a class="dropdown-item" role="menuitem" href="{{ ''|hub_url_generate_account }}" data-turbo-prefetch="false">{{ 'layout.navbar.account.myAccount'|trans }}</a>
                  </li>
                  <li>
                    {# Disable turbo : we may leave this app on logout #}
                    <a class="dropdown-item text-danger"
                      role="menuitem"
                      href="{{ '/logout'|hub_url_generate_account({ 'disconnect_user[_token]': csrf_token('hub/logout') }) }}"
                      data-turbo-prefetch="false"
                      data-turbo="false">
                      {{ 'layout.navbar.account.signOut'|trans }}
                    </a>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      {# Main title #}
      <div class="container-fluid text-center py-2">
        <h1>
          {{ title }}
        </h1>
      </div>
    </header>

    {# The MAIN block must be redefined on each page, including the flash block with the bood wrapper #}
    <main class="flex-grow-1" role="main" id="main-content">
      {% block main %}
        {{ block('flash', 'theme/flash.html.twig') }}
        <div class="text-center">
          Some content !
        </div>
      {% endblock %}
    </main>

    {# The FOOTER divided in two part : left/right on large screen / on the top of each other on small screen #}
    <footer role="contentinfo" aria-label="{{ 'aria.footer'|trans }}">
      <div class="container-fluid fw-light bg-body-secondary small mt-4 py-2">
        <div class="row gw-md-4">
          {# Left part : references to frameworks #}
          <div class="col-12 col-md-6 text-center text-md-end">
            {{ 'layout.footer.madeWith'|trans }}
            <span class="fa-brands fa-symfony"></span>
            <span class="fst-italic">Symfony 7</span>
            <span class="mx-1">|</span>
            <span class="fa-brands fa-bootstrap"></span>
            <span class="fst-italic">Bootstrap 5</span>
          </div>
          {# Right part : version and update of the app #}
          <div class="col-12 col-md-6 text-center text-md-start">
            {{ ('layout.footer.version'|trans) ~ ' ' ~ env.versioning.version ~ ' - ' ~ ('layout.footer.releaseDate'|trans) ~ ' '
              ~ (env.versioning.release_date|format_datetime('short', 'none')) }}
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>
